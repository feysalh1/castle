<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Mode - Children's Castle</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/child-dashboard.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/story-mode.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/loading-animations.css') }}">
</head>
<body class="story-mode-page">
    <header class="dashboard-header child-header">
        <div class="logo">
            <h1>Children's Castle</h1>
            <small>Developed for Menira</small>
        </div>
        <div class="story-nav">
            <a href="{{ url_for('child_dashboard') }}" class="btn back-btn">Back to Dashboard</a>
            <a href="{{ url_for('logout') }}" class="btn logout-btn">Sign Out</a>
        </div>
    </header>
    
    <main class="story-content">
        <h2 class="story-title">Story Mode</h2>
        
        <div class="story-selection">
            <label for="story-select">Choose a Story:</label>
            <select id="story-select">
                <option value="" disabled selected>Select a story</option>
                <option value="little_fox">The Little Fox</option>
                <option value="three_little_pigs">The Three Little Pigs</option>
                <option value="goldilocks">Goldilocks and the Three Bears</option>
                <option value="wild_things">Where the Wild Things Are</option>
                <option value="brown_bear">Brown Bear, Brown Bear</option>
                <option value="hungry_caterpillar">The Very Hungry Caterpillar</option>
                <option value="rainbow_fish">The Rainbow Fish</option>
                <option value="five_monkeys">Five Little Monkeys</option>
                <option value="black_sheep">Baa Baa Black Sheep</option>
                <option value="bo_peep">Little Bo Peep</option>
                <option value="jack_jill">Jack and Jill</option>
                <option value="hickory_dickory">Hickory Dickory Dock</option>
            </select>
        </div>
        
        <!-- Enhanced Stories Section -->
        {% if enhanced_stories %}
        <div class="story-selection enhanced-stories-section">
            <h3>Enhanced Stories with Character Voices</h3>
            <p>These stories feature character-specific voices and diverse representation.</p>
            
            <div class="enhanced-stories-grid">
                {% for story in enhanced_stories %}
                <div class="enhanced-story-card">
                    <h4>{{ story.title }}</h4>
                    {% if story.has_audio %}
                    <span class="audio-badge">ElevenLabs Narration</span>
                    {% endif %}
                    <p>Enjoy this interactive story with unique voices for each character!</p>
                    <a href="{{ url_for('story_enhancement.story_preview', story_id=story.id) }}" class="primary-btn">Read Story</a>
                </div>
                {% endfor %}
            </div>
        </div>

        <style>
            .enhanced-stories-section {
                margin-bottom: 40px;
                background-color: #f0e6ff;
                border: 2px solid #d4baff;
                padding: 20px;
                border-radius: 12px;
            }
            
            .enhanced-stories-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 15px;
                margin-top: 20px;
            }
            
            .enhanced-story-card {
                background-color: white;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                text-align: center;
                position: relative;
                overflow: hidden;
            }
            
            .enhanced-story-card h4 {
                color: #5a208f;
                margin-bottom: 5px;
            }
            
            .enhanced-story-card p {
                font-size: 0.9rem;
                color: #666;
                margin-bottom: 15px;
            }
            
            .audio-badge {
                display: inline-block;
                background-color: #8a5fff;
                color: white;
                font-size: 0.7rem;
                padding: 3px 8px;
                border-radius: 10px;
                margin-bottom: 10px;
            }
            
            @media (max-width: 768px) {
                .enhanced-stories-grid {
                    grid-template-columns: 1fr;
                }
            }
        </style>
        {% endif %}
        
        <div id="story-container" class="story-container">
            <div class="empty-story-message">
                <img src="{{ url_for('static', filename='images/icons/book.svg') }}" alt="Book Icon" class="empty-icon">
                <p>Choose a story from the list above to begin!</p>
            </div>
            
            <div class="story-content-wrapper" style="display: none;">
                <div class="story-image">
                    <img id="story-illustration" src="" alt="Story Illustration">
                </div>
                
                <div class="story-text">
                    <p id="story-paragraph"></p>
                </div>
                
                <div class="story-controls">
                    <button id="prev-btn" class="btn nav-btn">Previous</button>
                    <button id="play-btn" class="btn primary-btn">Play / Pause</button>
                    <button id="next-btn" class="btn nav-btn">Next</button>
                </div>
                
                <div class="story-progress">
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                    <div class="progress-text">
                        Page <span id="current-page">0</span> of <span id="total-pages">0</span>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <script src="{{ url_for('static', filename='js/story-reader.js') }}"></script>
    <div id="loading-animation" class="loading-container" style="display: none;">
        <div class="loading-content">
            <div class="fox-animation"></div>
            <p>Loading your adventure...</p>
        </div>
    </div>
</body>
</html>
